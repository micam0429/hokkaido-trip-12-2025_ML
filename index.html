<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Hokkaido 2025</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Hokkaido 2025">

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/lucide-react@0.554.0/umd/lucide-react.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['"Noto Sans TC"', 'sans-serif'],
              display: ['"Zen Maru Gothic"', 'sans-serif'],
            },
            colors: {
              'hokkaido-blue': '#a0c4ff',
              'hokkaido-snow': '#f8f9fa',
              'hokkaido-accent': '#ff6b6b',
              'hokkaido-text': '#2d3436',
              'paper': '#fffdf5',
            }
          }
        }
      }
    </script>
    <style>
      body {
        background-color: #f0f2f5;
        -webkit-overflow-scrolling: touch;
      }
      .hide-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    </style>
</head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      // --- 1. ä¾è³´é …å’Œé¡å‹å®šç¾© (åŒ…å«æ‰€æœ‰è¡Œç¨‹è³‡æ–™) ---
      
      const { useState, useEffect, useMemo } = React;
      
      // ğŸ“Œ é˜²ç¦¦æ€§è¼‰å…¥ç­–ç•¥ï¼šç•¶ Lucide Icons è¼‰å…¥å¤±æ•—æ™‚ï¼Œä½¿ç”¨ NullIcon é¿å…ç¨‹å¼å´©æ½°
      const NullIcon = ({ size, className }) => <div className={`${className || ''}`} style={{ width: size, height: size }}></div>;
      
      let MapPin = NullIcon, Clock = NullIcon, Train = NullIcon, Utensils = NullIcon, Camera = NullIcon, Hotel = NullIcon, X = NullIcon, Navigation = NullIcon, Wallet = NullIcon, Info = NullIcon, Calendar = NullIcon, ChevronRight = NullIcon, Plus = NullIcon, Trash2 = NullIcon, Divide = NullIcon, Calculator = NullIcon, CreditCard = NullIcon, DollarSign = NullIcon, CloudRain = NullIcon, CloudSnow = NullIcon, Sun = NullIcon, Cloud = NullIcon, Thermometer = NullIcon, Plane = NullIcon, Phone = NullIcon, ShieldAlert = NullIcon;
      
      // æª¢æŸ¥ LucideReact æ˜¯å¦é€é CDN æˆåŠŸè¼‰å…¥åˆ°å…¨åŸŸ window ç‰©ä»¶
      const LucideIcons = window.LucideReact;

      if (LucideIcons) {
          // åªæœ‰ç•¶ window.LucideReact å­˜åœ¨æ™‚ï¼Œæ‰é€²è¡Œè§£æ§‹è¦†è“‹ï¼Œæ­¤æ™‚æ‰€æœ‰çš„åœ–æ¨™éƒ½æ˜¯ React çµ„ä»¶
          ({ 
              MapPin, Clock, Train, Utensils, Camera, Hotel, X, Navigation, Wallet, Info, Calendar, ChevronRight, Plus, Trash2, Divide, Calculator, CreditCard, DollarSign, CloudRain, CloudSnow, Sun, Cloud, Thermometer, Plane, Phone, ShieldAlert 
          } = LucideIcons);
      }

      // é¡å‹å®šç¾©
      const Category = { Flight: 'Flight', Transport: 'Transport', Food: 'Food', Sightseeing: 'Sightseeing', Hotel: 'Hotel' };

      // ITINERARY_DATA è¡Œç¨‹è³‡æ–™
      const ITINERARY_DATA = [
        {
          day: 1,
          date: '12/03',
          weekday: 'ä¸‰',
          city: 'Hakodate',
          lat: 41.7687,
          lng: 140.7291,
          title: 'æŠµé”åŒ—æµ·é“ãƒ»å‡½é¤¨',
          items: [
            {
              id: 'd1-flight',
              time: '08:45 - 14:20',
              title: 'èˆªç­ HX690',
              category: Category.Flight,
              description: 'HKG â†’ CTS (æ–°åƒæ­²æ©Ÿå ´)',
              location: 'New Chitose Airport',
              details: ['èµ·é£›: 08:45 HKG', 'é™è½: 14:20 CTS']
            },
            {
              id: 'd1-transport-hakodate',
              time: '15:50',
              title: 'JR ç‰¹æ€¥åŒ—æ–— 18 è™Ÿ',
              category: Category.Transport,
              description: 'å—åƒæ­² â†’ å‡½é¤¨',
              location: 'Minami-Chitose Station',
              cost: 'Â¥9,460 (æŒ‡å®šå¸­)',
              tags: ['æœ€ä½³ç­æ¬¡', 'éœ€é ç´„'],
              details: [
                'æœ€ä½³ç­æ¬¡: Hokuto 18',
                'æ™‚é–“: å—åƒæ­² 15:50 ç™¼ â†’ å‡½é¤¨ 19:30 æŠµ',
                'è»Šè²»: ç´„ Â¥9,460 (æŒ‡å®šå¸­) / Â¥8,930 (è‡ªç”±å¸­)',
                'è·¯å¾‘: æ©Ÿå ´æ­ã€Œå¿«é€Ÿ Airportã€è‡³ã€Œå—åƒæ­²ã€(3åˆ†é˜) è½‰ä¹˜',
                'å¾Œå‚™: ç‰¹æ€¥åŒ—æ–— 20 è™Ÿ (17:26 ç™¼)'
              ]
            },
            {
              id: 'd1-hotel',
              time: 'Check-in',
              title: 'JR Inn å‡½é¤¨',
              category: Category.Hotel,
              description: 'ä½æ–¼å‡½é¤¨ç«™æ—ï¼Œäº¤é€šæ¥µä¾¿åˆ©',
              location: 'JR Inn Hakodate',
              tags: ['ä½å®¿']
            },
            {
              id: 'd1-dinner',
              time: 'æ™šé¤',
              title: 'é¾é³³ å¤§é–€æ¨ªä¸åº—',
              jpTitle: 'Ryuho',
              category: Category.Food,
              description: 'æ˜­å’Œæ°£æ°›è€å­—è™Ÿæ‹‰éºµ',
              location: 'Daimon Yokocho',
              tags: ['å¿…åƒç¾é£Ÿ', 'é»ƒé‡‘é¹½å‘³æ‹‰éºµ'],
              details: [
                'ä½æ–¼ã€Œå¤§é–€æ©«ä¸ã€å±‹å°æ‘å…§',
                'å¿…åƒ: é»ƒé‡‘é¹½å‘³æ‹‰éºµ (æ¹¯é ­é€äº®é›æ²¹æå‘³)',
                'å¿…åƒ: ç…é¤ƒ (çš®è–„é¤¡å¤š)'
              ],
              imageUrl: 'https://picsum.photos/400/300?random=1'
            }
          ]
        },
        {
          day: 2,
          date: '12/04',
          weekday: 'å››',
          city: 'Hakodate',
          lat: 41.7687,
          lng: 140.7291,
          title: 'å‡½é¤¨ç¶“å…¸å·¡ç¦®',
          items: [
            {
              id: 'd2-breakfast',
              time: 'æ—©é¤',
              title: 'å‡½é¤¨æœå¸‚ - æµ·çœŸ',
              jpTitle: 'Kaishin',
              category: Category.Food,
              description: 'å¸‚å ´å…§çš„éš±è—å¥½åº—',
              location: 'Hakodate Morning Market',
              tags: ['çƒ¤æ‰‡è²', 'ç”Ÿè ”'],
              details: ['å¿…åƒ: çƒ¤æ‰‡è²/æ´»æ‰‡è² (è‚‰è³ªè‚¥åš)', 'å¿…åƒ: ç”Ÿè ” (åšå²¸ç”¢ï¼Œå¥¶é¦™å‘³é‡)']
            },
            {
              id: 'd2-transport-goryokaku',
              time: '11:00',
              title: 'ç§»å‹•è‡³äº”ç¨œéƒ­',
              category: Category.Transport,
              description: 'å‡½é¤¨å·´å£« 25/33 è™Ÿ',
              location: 'Hakodate Station Bus Terminal',
              cost: 'Â¥240',
              details: ['è»Šç¨‹ç´„ 20 åˆ†é˜', 'å¾Œå‚™: å¸‚é›»å¾€æ¹¯ä¹‹å·æ–¹å‘ (Â¥230)']
            },
            {
              id: 'd2-spot-tower',
              time: '11:30',
              title: 'äº”ç¨œéƒ­å¡”',
              category: Category.Sightseeing,
              description: 'ä¿¯ç°æ˜Ÿå½¢è¦å¡',
              location: 'Goryokaku Tower',
              tags: ['å¿…æ‹'],
              details: ['æ–°é¸çµ„åœŸæ–¹æ­²ä¸‰æœ€å¾Œæˆ°å ´', 'å¿…ç™»å¡”ä¿¯ç°æ˜Ÿå½¢']
            },
            {
              id: 'd2-lunch',
              time: '12:30',
              title: 'æ‘ä¸Šæµ·è†½ å‡½é¤¨æœ¬åº—',
              jpTitle: 'Uni Murakami',
              category: Category.Food,
              description: 'ç„¡æ·»åŠ æ˜ç¤¬æµ·è†½',
              location: 'Uni Murakami Hakodate',
              tags: ['ç”Ÿæµ·è†½ä¸¼'],
              details: ['æ¨™æ¦œä¸ä½¿ç”¨æ˜ç¤¬', 'å¿…åƒ: ç”Ÿæµ·è†½ä¸¼ (ç”˜ç”œç„¡è‹¦å‘³)']
            },
            {
              id: 'd2-spot-slope',
              time: '14:00',
              title: 'å…«å¹¡å‚',
              category: Category.Sightseeing,
              description: 'é€šå¾€å¤§æµ·çš„å¡é“',
              location: 'Hachimanzaka',
              tags: ['æ‰“å¡é»'],
              details: ['è·¯é¢å»¶ä¼¸è‡³æ¸¯å£èˆ‡æ‘©å‘¨ä¸¸è™Ÿçš„æ™¯è‰²']
            },
            {
              id: 'd2-nightview',
              time: '15:00',
              title: 'å‡½é¤¨å±±å¤œæ™¯',
              category: Category.Sightseeing,
              description: 'ä¸–ç•Œä¸‰å¤§å¤œæ™¯',
              location: 'Mt. Hakodate Ropeway',
              cost: 'Â¥1,800 (ä¾†å›)',
              tags: ['å¿…å»', 'ä¿æš–'],
              details: ['æ—¥è½å‰æŠµé”', 'å†¬å­£å±±é ‚æ¥µå†·ï¼Œå‹™å¿…æˆ´å¸½åœå·¾', 'çºœè»Šç´„3åˆ†é˜']
            },
            {
              id: 'd2-dinner',
              time: 'æ™šé¤',
              title: 'å¹¸é‹å°ä¸‘æ¼¢å ¡',
              jpTitle: 'Lucky Pierrot',
              category: Category.Food,
              description: 'å‡½é¤¨é™å®š',
              location: 'Lucky Pierrot Marina',
              tags: ['No.1äººæ°£', 'ä¸­è¯é›è…¿å ¡'],
              details: ['å¿…åƒ: ä¸­è¯é›è…¿æ¼¢å ¡ (é…¸ç”œé†¬æ±)', 'å¿…åƒ: å¹¸é‹è–¯æ¢ (æ·‹ä¸Šè‚‰é†¬èµ·å¸)']
            }
          ]
        },
        {
          day: 3,
          date: '12/05',
          weekday: 'äº”',
          city: 'Toyako',
          lat: 42.5583,
          lng: 140.8244,
          title: 'æ´çˆºæ¹–æº«æ³‰',
          items: [
            {
              id: 'd3-breakfast',
              time: 'æ—©é¤',
              title: 'å‡½é¤¨æœå¸‚',
              category: Category.Food,
              description: 'å°ˆæ”»èƒèŸ¹æ–™ç†',
              location: 'Hakodate Morning Market',
              tags: ['å¸ç‹èŸ¹', 'æ¯›èŸ¹'],
              details: ['å»ºè­°é¸æ“‡ç¾ç…®èƒèŸ¹æˆ–åˆºèº«']
            },
            {
              id: 'd3-transport',
              time: '10:40',
              title: 'JR ç‰¹æ€¥åŒ—æ–— 7 è™Ÿ',
              category: Category.Transport,
              description: 'å‡½é¤¨ â†’ æ´çˆº',
              location: 'Hakodate Station',
              cost: 'Â¥5,920',
              tags: ['æŒ‡å®šå¸­'],
              details: ['10:40 ç™¼ -> 12:34 æŠµ', 'å¾Œå‚™: åŒ—æ–—9è™Ÿ (12:15ç™¼)']
            },
            {
              id: 'd3-lunch',
              time: 'åˆé¤',
              title: 'SoupCurry HLAHAL',
              jpTitle: 'å“ˆæ‹‰å“ˆãƒ«',
              category: Category.Food,
              description: 'ç¾Šæ’æ¹¯å’–å“©',
              location: 'SoupCurry HLAHAL',
              tags: ['ç¾Šæ’', 'ç‰›è’¡ç‰‡'],
              details: ['å¿…åƒ: ç¾Šæ’æ¹¯å’–å“© (è»Ÿå«©ç„¡é¨·å‘³)', 'å¿…åƒ: ç‚¸ç‰›è’¡ç‰‡']
            },
            {
              id: 'd3-hotel',
              time: 'Check-in',
              title: 'æ¹–æ™¯ TOYA ä¹ƒä¹‹é¢¨',
              category: Category.Hotel,
              description: 'é ‚æ¨“éœ²å¤©é¢¨å‘‚ Infinity Onsen',
              location: 'The Lake View Toya Nonokaze Resort',
              tags: ['æº«æ³‰', 'è‡ªåŠ©æ™šé¤'],
              details: ['æ™šé¤: 19:00 é…’åº—è‡ªåŠ©é¤', 'è¨­æ–½: é ‚æ¨“éœ²å¤©é¢¨å‘‚ TENQOO']
            }
          ]
        },
        {
          day: 4,
          date: '12/06',
          weekday: 'å…­',
          city: 'Sapporo',
          lat: 43.0618,
          lng: 141.3545,
          title: 'æœ­å¹Œå¥¢è¯è³¼ç‰©',
          items: [
            {
              id: 'd4-transport',
              time: '10:00',
              title: 'ä¹ƒä¹‹é¢¨æ¥é§å·´å£«',
              category: Category.Transport,
              description: 'é£¯åº— â†’ æœ­å¹Œç«™åŒ—å£',
              location: 'Toya Nonokaze',
              cost: 'å…è²»',
              tags: ['å·²é ç´„'],
              details: ['10:00 å¤§å»³é›†åˆ', 'ç´„ 12:30 æŠµé”æœ­å¹Œ']
            },
            {
              id: 'd4-lunch',
              time: 'åˆé¤',
              title: 'æ ¹å®¤èŠ±ä¸¸',
              jpTitle: 'Nemuro Hanamaru',
              category: Category.Food,
              description: 'JR Stellar Place 6F',
              location: 'JR Tower Stellar Place',
              tags: ['éœ€æŠ½è™Ÿç¢¼ç‰Œ', 'äºŒå±¤å¸†ç«‹è²'],
              details: ['å¿…åƒ: äºŒå±¤å¸†ç«‹è²', 'å¿…åƒ: é†¬æ¼¬é®­é­šåµ', 'æ³¨æ„: éœ€å…ˆå»æŠ½è™Ÿç¢¼ç‰Œ']
            },
            {
              id: 'd4-shop',
              time: 'ä¸‹åˆ',
              title: 'æœ­å¹Œç«™è³¼ç‰©',
              category: Category.Sightseeing,
              description: 'å¤§ä¸¸ã€ä¸¸äº•ä»Šäº•',
              location: 'Daimaru Sapporo',
              details: ['å¤§ä¸¸: ç²¾å“ (LV, Gucci)', '2nd Street: äºŒæ‰‹ç²¾å“', 'ä¸¸äº•ä»Šäº•: è¨­è¨ˆå¸«å“ç‰Œ']
            },
            {
              id: 'd4-dinner',
              time: '19:00',
              title: 'æˆå‰æ€æ±— å¤§é»‘å±‹',
              category: Category.Food,
              description: 'æœ­å¹Œ 3 è™Ÿåº—',
              location: 'Daikokuya Genghis Khan',
              tags: ['å·²é ç´„', 'ç”Ÿç¾Šè‚‰'],
              details: ['å¿…åƒ: ç”Ÿç¾Šè‚‰ (ç”Ÿãƒ©ãƒ )', 'å¸¶éª¨ç¾Šæ’', 'ç„¡ç¾Šé¨·å‘³']
            },
            {
              id: 'd4-supper',
              time: 'å®µå¤œ',
              title: 'æœ­å¹Œæ‹‰éºµ è¼é¢¨',
              category: Category.Food,
              description: 'æ¿ƒåšå‘³å™Œæ‹‰éºµ',
              location: 'Ramen Kifuu',
              details: ['æ¹¯é ­é‡‘é»ƒï¼Œèºæ—‹éºµæ¢å¸æ¹¯']
            }
          ]
        },
        {
          day: 5,
          date: '12/07',
          weekday: 'æ—¥',
          city: 'Otaru',
          lat: 43.1907,
          lng: 140.9947,
          title: 'å°æ¨½æµªæ¼«ä¹‹æ—…',
          items: [
            {
              id: 'd5-transport',
              time: '08:30',
              title: 'JR å¿«é€Ÿ Airport',
              category: Category.Transport,
              description: 'æœ­å¹Œ â†’ å°æ¨½',
              location: 'Sapporo Station',
              cost: 'Â¥750',
              details: ['è»Šç¨‹ç´„ 35 åˆ†é˜']
            },
            {
              id: 'd5-brunch',
              time: '10:00',
              title: 'æµ·è†½å°ˆé–€åº— ä¸–å£¹å±‹',
              category: Category.Food,
              description: 'å·²é ç´„',
              location: 'Yoichi-ya Otaru',
              tags: ['å·²é ç´„', '5ç¨®æµ·è†½ä¸¼'],
              details: ['å¿…åƒ: 5ç¨®æµ·è†½è©•æ¯”ä¸¼']
            },
            {
              id: 'd5-spot-canal',
              time: '11:30',
              title: 'å°æ¨½é‹æ²³',
              category: Category.Sightseeing,
              description: 'æ‹ç…§æ‰“å¡',
              location: 'Otaru Canal',
              details: ['æ˜”æ—¥é‡‘èä¸­å¿ƒéºè·¡', 'ç™½å¤©æ‹å€’å½±']
            },
            {
              id: 'd5-shop-street',
              time: '12:30',
              title: 'å ºç”ºé€šå•†åº—è¡—',
              category: Category.Sightseeing,
              description: 'ç”œé»ä¸€ç´šæˆ°å€',
              location: 'Sakaimachi Street',
              tags: ['LeTAO', 'åŒ—è“æ¨“', 'å…­èŠ±äº­'],
              details: [
                'LeTAO: é›™å±¤èµ·å¸è›‹ç³•',
                'åŒ—è“æ¨“: å¦–ç²¾ä¹‹æ£®å¹´è¼ªè›‹ç³•ã€å¤¢ä¸æ€è­°æ³¡èŠ™',
                'å…­èŠ±äº­: è˜­å§†è‘¡è„å¥¶æ²¹å¤¾å¿ƒé¤…'
              ]
            },
            {
              id: 'd5-music',
              time: '13:30',
              title: 'å°æ¨½éŸ³æ¨‚ç›’å ‚',
              category: Category.Sightseeing,
              description: 'é–€å£è’¸æ°£é˜',
              location: 'Otaru Music Box Museum',
              details: ['è’¸æ°£é˜æ¯15åˆ†é˜å ±æ™‚']
            },
            {
              id: 'd5-dinner',
              time: '17:00',
              title: 'å°æ¨½ãŠã‚Šé®¨',
              jpTitle: 'Orisushi',
              category: Category.Food,
              description: 'å·²é ç´„',
              location: 'Otaru Orisushi',
              tags: ['å·²é ç´„', 'æ­·å²å»ºç¯‰'],
              details: ['æ°›åœå¾©å¤']
            },
            {
              id: 'd5-market',
              time: 'æ™šä¸Š',
              title: 'å¤§é€šå…¬åœ’ è–èª•å¸‚é›†',
              category: Category.Sightseeing,
              description: 'å¾·åœ‹æ…•å°¼é»‘æ°£æ°›',
              location: 'Odori Park',
              tags: ['ç†±ç´…é…’'],
              details: ['å¿…åƒ: ç†±ç´…é…’, çƒ¤æä»', 'ç”œé»: Kinotoya é›ªç³•']
            }
          ]
        },
        {
          day: 6,
          date: '12/08',
          weekday: 'ä¸€',
          city: 'Sapporo',
          lat: 43.0618,
          lng: 141.3545,
          title: 'æœ­å¹Œè²·è²·è²·',
          items: [
            {
              id: 'd6-breakfast',
              time: 'æ—©é¤',
              title: 'å ´å¤–å¸‚å ´ ã†ã‚ã‡å ‚',
              jpTitle: 'Ume-do',
              category: Category.Food,
              description: 'èƒèŸ¹ä¸¼',
              location: 'Sapporo Central Wholesale Market',
              details: ['å¿…åƒ: èƒèŸ¹ä¸¼', 'å¿…åƒ: èŠ±å’²èŸ¹éµç ²æ±']
            },
            {
              id: 'd6-spot-beer',
              time: '09:30',
              title: 'æœ­å¹Œå•¤é…’åšç‰©é¤¨',
              category: Category.Sightseeing,
              description: 'ç´…ç£šå»ºç¯‰',
              location: 'Sapporo Beer Museum',
              details: ['äº¤é€š: ä¸­å¤®å·´å£«188/88è™Ÿ', 'å¿…å–: 1Fè©¦é£²ã€Œä¸‰ç¨®å•¤é…’è©•æ¯”çµ„ã€', 'é™å®š: é–‹æ‹“ä½¿éº¥é…’']
            },
            {
              id: 'd6-lunch',
              time: 'åˆé¤',
              title: 'å¥§èŠå•†åº—',
              jpTitle: 'Okushiba Shoten',
              category: Category.Food,
              description: 'é®®è¦æ¹¯å’–å“©',
              location: 'Okushiba Shoten Station',
              details: ['å¤§é‡è¦é ­ç†¬ç…®æ¹¯åº•']
            },
            {
              id: 'd6-shop-anime',
              time: 'ä¸‹åˆ',
              title: 'å‹•æ¼«è³¼ç‰©',
              category: Category.Sightseeing,
              description: 'Pokemon, Parco',
              location: 'Pokemon Center Sapporo',
              tags: ['é›ªå­£çš®å¡ä¸˜'],
              details: ['Pokemon Center: å¤§ä¸¸8F', 'Parco: Jump Shop', 'Animate: ä¸¸å¤§æ¨“']
            },
            {
              id: 'd6-dinner',
              time: '19:00',
              title: 'å£½å–œç‡’ ä¸‰å…‰èˆ',
              category: Category.Food,
              description: 'å·²é ç´„',
              location: 'Sankousha Sapporo',
              tags: ['å·²é ç´„', 'ç™¾å¹´è€åº—'],
              details: ['ç§˜è£½å‘³å™Œé†¬åº•', 'é»‘æ¯›å’Œç‰›']
            }
          ]
        },
        {
          day: 7,
          date: '12/09',
          weekday: 'æ—¥',
          city: 'Sapporo',
          lat: 43.0618,
          lng: 141.3545,
          title: 'ä¼‘é–’æ¼«æ­¥',
          items: [
            {
              id: 'd7-breakfast',
              time: 'æ—©é¤',
              title: 'McDonald\'s',
              category: Category.Food,
              description: 'æ—¥æœ¬é™å®š',
              location: 'Sapporo',
              details: ['Gracoro å¥¶æ²¹å¯æ¨‚é¤…æ¼¢å ¡', 'McGriddles é¬†é¤…è±¬è‚‰æ»¿ç¦å ¡']
            },
            {
              id: 'd7-spot-park',
              time: 'ä¸Šåˆ',
              title: 'ä¸­å³¶å…¬åœ’',
              category: Category.Sightseeing,
              description: 'é›ªæ™¯æ£®æ—',
              location: 'Nakajima Park',
              details: ['è±å¹³é¤¨ (é‡è¦æ–‡åŒ–è²¡)', 'è—ç™½è‰²æ´‹å¼å»ºç¯‰']
            },
            {
              id: 'd7-shop-final',
              time: 'æ™šä¸Š',
              title: 'æ¥­å‹™è¶…å¸‚',
              category: Category.Sightseeing,
              description: 'æœ€å¾Œè£œè²¨',
              location: 'Gyomu Super Sapporo',
              details: ['é›¶é£Ÿã€èª¿å‘³æ–™ã€æŸšå­èƒ¡æ¤’']
            }
          ]
        },
        {
          day: 8,
          date: '12/10',
          weekday: 'ä¸‰',
          city: 'Chitose',
          lat: 42.793,
          lng: 141.673,
          title: 'æ©Ÿå ´æœ€å¾Œæ‹¼æ',
          items: [
            {
              id: 'd8-transport',
              time: '08:30',
              title: 'JR å¿«é€Ÿ Airport',
              category: Category.Transport,
              description: 'æœ­å¹Œ â†’ æ–°åƒæ­²æ©Ÿå ´',
              location: 'Sapporo Station',
              cost: 'Â¥1,150 (è‡ªç”±å¸­)',
              tags: [],
              details: ['è»Šç¨‹ 37 åˆ†é˜', 'u-seat æŒ‡å®šå¸­ Â¥1,990']
            },
            {
              id: 'd8-shop',
              time: 'æ©Ÿå ´',
              title: 'åœ‹å…§ç·šèˆªå»ˆ 2F',
              category: Category.Sightseeing,
              description: 'ä¼´æ‰‹ç¦®æ”»ç•¥',
              location: 'New Chitose Airport Domestic Terminal',
              tags: ['SNAFFLE\'S', 'ç¾ç‘›é¸æœ'],
              details: [
                'SNAFFLE\'S èµ·å¸è›‹ç³•',
                'åŒ—è“æ¨“ é–‹æ‹“ç±³æœ',
                'ç¾ç‘›é¸æœ ç‰ç±³éºµåŒ… (æ¯æ—¥é™é‡)',
                'Kinotoya è›‹å¡”'
              ]
            },
            {
              id: 'd8-flight',
              time: '16:30',
              title: 'èˆªç­ HX693',
              category: Category.Flight,
              description: 'CTS â†’ HKG',
              location: 'New Chitose Airport',
              details: ['èµ·é£›: 16:30 CTS', 'é™è½: 21:50 HKG']
            }
          ]
        }
      ];

      // --- 2. çµ„ä»¶å…§å®¹ ---
      
      // InfoView (åŒ…å«ä½å®¿ã€èˆªç­ã€ç·Šæ€¥è¯çµ¡è³‡è¨Š)
      const InfoView = () => {
        return (
          <div className="space-y-6 pb-24">
            {/* Flights */}
            <section className="bg-white rounded-2xl p-5 shadow-sm border border-stone-100">
              <h2 className="text-lg font-display font-bold text-stone-800 mb-4 flex items-center gap-2">
                <Plane className="text-blue-400" /> èˆªç­è³‡è¨Š
              </h2>
              <div className="space-y-4">
                <div className="bg-blue-50 p-4 rounded-xl">
                  <div className="text-xs text-blue-500 font-bold mb-1">å»ç¨‹ | 12/03 (ä¸‰)</div>
                  <div className="flex justify-between items-center">
                    <div>
                      <div className="text-2xl font-bold text-blue-900">HKG</div>
                      <div className="text-sm text-blue-700">08:45</div>
                    </div>
                    <div className="text-blue-300">âœˆ</div>
                    <div className="text-right">
                      <div className="text-2xl font-bold text-blue-900">CTS</div>
                      <div className="text-sm text-blue-700">14:20</div>
                    </div>
                  </div>
                  <div className="text-xs text-center mt-2 text-blue-600">Hong Kong Airlines HX690</div>
                </div>
                
                <div className="bg-stone-50 p-4 rounded-xl">
                  <div className="text-xs text-stone-500 font-bold mb-1">å›ç¨‹ | 12/10 (ä¸‰)</div>
                  <div className="flex justify-between items-center">
                    <div>
                      <div className="text-2xl font-bold text-stone-700">CTS</div>
                      <div className="text-sm text-stone-600">16:30</div>
                    </div>
                    <div className="text-stone-300">âœˆ</div>
                    <div className="text-right">
                      <div className="text-2xl font-bold text-stone-700">HKG</div>
                      <div className="text-sm text-stone-600">21:50</div>
                    </div>
                  </div>
                  <div className="text-xs text-center mt-2 text-stone-500">Hong Kong Airlines HX693</div>
                </div>
              </div>
            </section>

            {/* Hotels */}
            <section className="bg-white rounded-2xl p-5 shadow-sm border border-stone-100">
              <h2 className="text-lg font-display font-bold text-stone-800 mb-4 flex items-center gap-2">
                <Hotel className="text-emerald-400" /> ä½å®¿è³‡è¨Š
              </h2>
              <div className="space-y-4">
                {[
                  { name: 'JR Inn Hakodate', city: 'å‡½é¤¨', note: 'å°±åœ¨JRç«™æ—ï¼Œæ•é ­å¯è‡ªé¸ï¼Œé ‚æ¨“æœ‰å¤§æµ´å ´' },
                  { name: 'Toya Nonokaze Resort', city: 'æ´çˆºæ¹–', note: 'å…¨å®¤æ¹–æ™¯ï¼Œé ‚æ¨“ç„¡é‚Šéš›æº«æ³‰ï¼Œç…™ç«æ™¯è‰²' },
                  { name: 'Dormy Inn Sapporo Annex', city: 'æœ­å¹Œ', note: 'ç‹¸å°è·¯å•†åº—è¡—å…§ï¼Œæä¾›å…è²»å¤œé³´æ‹‰éºµ' }
                ].map((h, i) => (
                  <div key={i} className="border-b border-stone-100 pb-3 last:border-0 last:pb-0">
                    <div className="flex justify-between items-baseline">
                      <h3 className="font-bold text-stone-800">{h.name}</h3>
                      <span className="text-xs bg-emerald-100 text-emerald-600 px-2 py-0.5 rounded-full">{h.city}</span>
                    </div>
                    <p className="text-sm text-stone-500 mt-1 leading-relaxed">{h.note}</p>
                  </div>
                ))}
              </div>
            </section>

            {/* Emergency */}
            <section className="bg-red-50 rounded-2xl p-5 shadow-sm border border-red-100">
              <h2 className="text-lg font-display font-bold text-red-800 mb-4 flex items-center gap-2">
                <ShieldAlert className="text-red-500" /> ç·Šæ€¥è¯çµ¡
              </h2>
              <div className="space-y-3">
                <a href="tel:110" className="flex items-center gap-3 bg-white p-3 rounded-xl shadow-sm">
                  <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-red-500 font-bold">110</div>
                  <div>
                    <div className="font-bold text-stone-800">æ—¥æœ¬è­¦å¯Ÿå±€</div>
                    <div className="text-xs text-stone-500">ç·Šæ€¥äº‹æ•…ã€å ±æ¡ˆ</div>
                  </div>
                </a>
                <a href="tel:119" className="flex items-center gap-3 bg-white p-3 rounded-xl shadow-sm">
                  <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-red-500 font-bold">119</div>
                  <div>
                    <div className="font-bold text-stone-800">æ—¥æœ¬æ•‘è­·/ç«è­¦</div>
                    <div className="text-xs text-stone-500">é†«ç™‚æ€¥æ•‘</div>
                  </div>
                </a>
                <div className="mt-4 pt-4 border-t border-red-100">
                  <div className="flex items-center gap-2 mb-2">
                      <Phone size={16} className="text-red-400"/>
                      <span className="font-bold text-red-900 text-sm">é¦™æ¸¯å…¥å¢ƒè™•æ±‚åŠ©ç†±ç·š</span>
                  </div>
                  <p className="text-xs text-red-700 mb-1">å…¨çƒå…ä»˜è²»é›»è©±: +852 1868</p>
                  <div className="flex items-center gap-1 text-xs text-red-500">
                    <Clock size={12} />
                    <span>24å°æ™‚é‹ä½œ</span>
                  </div>
                </div>
              </div>
            </section>
          </div>
        );
      };
      
      // WeatherWidget
      const WeatherWidget = ({ lat, lng, city }) => {
        const [weather, setWeather] = useState(null);
        const [loading, setLoading] = useState(true);

        useEffect(() => {
          const fetchWeather = async () => {
            setLoading(true);
            try {
              // Fetch current weather from Open-Meteo (Free, No key required)
              const response = await fetch(
                `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lng}&current_weather=true`
              );
              const data = await response.json();
              if (data.current_weather) {
                setWeather({
                  temperature: data.current_weather.temperature,
                  weatherCode: data.current_weather.weathercode,
                  windSpeed: data.current_weather.windspeed
                });
              }
            } catch (error) {
              console.error("Failed to fetch weather", error);
            } finally {
              setLoading(false);
            }
          };

          // åªæœ‰åœ¨ lat å’Œ lng æ˜¯æœ‰æ•ˆæ•¸å­—æ™‚æ‰æŠ“å–
          if (typeof lat === 'number' && typeof lng === 'number' && lat !== 0 && lng !== 0) {
              fetchWeather();
          } else {
              setLoading(false);
              setWeather(null);
          }
        }, [lat, lng]);

        const getWeatherIcon = (code) => {
          // WMO Weather interpretation codes
          if (code <= 1) return <Sun className="w-8 h-8 text-orange-400" />;
          if (code <= 3) return <Cloud className="w-8 h-8 text-gray-400" />;
          if (code <= 69) return <CloudRain className="w-8 h-8 text-blue-400" />;
          return <CloudSnow className="w-8 h-8 text-sky-300" />;
        };

        const getWeatherDesc = (code) => {
          if (code <= 1) return 'æ™´æœ—';
          if (code <= 3) return 'å¤šé›²';
          if (code <= 69) return 'æœ‰é›¨';
          return 'æœ‰é›ª';
        };
        
        if (!lat || !lng) {
            return (
                <div className="bg-gradient-to-br from-blue-50 to-white rounded-2xl p-4 shadow-sm border border-blue-100 flex items-center justify-between mb-4">
                    <span className="text-sm text-gray-500">è¡Œç¨‹è³‡æ–™ä¸­ç¼ºå°‘åº§æ¨™ï¼Œç„¡æ³•é¡¯ç¤ºå¤©æ°£ã€‚</span>
                </div>
            )
        }

        return (
          <div className="bg-gradient-to-br from-blue-50 to-white rounded-2xl p-4 shadow-sm border border-blue-100 flex items-center justify-between mb-4">
            <div>
              <h3 className="text-sm text-gray-500 font-display mb-1">{city} å³æ™‚å¤©æ°£</h3>
              {loading ? (
                <div className="text-xl font-bold text-gray-400">Loading...</div>
              ) : (
                <div className="flex items-end gap-2">
                  <span className="text-3xl font-bold text-gray-800 font-display">
                    {weather?.temperature}Â°C
                  </span>
                  <span className="text-sm text-gray-600 mb-1">
                    {weather ? getWeatherDesc(weather.weatherCode) : '--'}
                  </span>
                </div>
              )}
            </div>
            <div className="flex flex-col items-center">
              {loading ? <Cloud className="w-8 h-8 text-gray-300 animate-pulse" /> : (weather && getWeatherIcon(weather.weatherCode))}
              <div className="flex items-center gap-1 mt-1 text-xs text-gray-400">
                <Thermometer size={12} />
                <span>é¢¨é€Ÿ {weather?.windSpeed || '--'} km/h</span>
              </div>
            </div>
          </div>
        );
      };
      
      // ExpenseTracker
      const ExpenseTracker = () => {
        const [expenses, setExpenses] = useState([]);
        const [title, setTitle] = useState('');
        const [amount, setAmount] = useState('');
        const [paymentMethod, setPaymentMethod] = useState('');
        
        const [splits, setSplits] = useState({ dad: 0, mom: 0, heng: 0, yan: 0 });

        const handleSplitEvenly = () => {
          const val = parseFloat(amount);
          if (isNaN(val) || val <= 0) return;
          const share = Math.round((val / 4) * 100) / 100; // Round to 2 decimals
          setSplits({ dad: share, mom: share, heng: share, yan: share });
        };

        const handleAddExpense = () => {
          if (!title || !amount) return;
          
          const newExpense = { 
            id: Date.now().toString(),
            item: title,
            total: parseFloat(amount),
            payer: 'Main', 
            splits: { ...splits },
            paymentMethod: paymentMethod || 'Cash'
          };

          setExpenses([...expenses, newExpense]);
          // Reset
          setTitle('');
          setAmount('');
          setPaymentMethod('');
          setSplits({ dad: 0, mom: 0, heng: 0, yan: 0 });
        };

        const handleDelete = (id) => { 
          setExpenses(expenses.filter(e => e.id !== id));
        };

        // Summaries
        const totalSpent = useMemo(() => expenses.reduce((acc, curr) => acc + curr.total, 0), [expenses]);
        
        const totalPerPerson = useMemo(() => {
          return expenses.reduce((acc, curr) => ({
            dad: acc.dad + curr.splits.dad,
            mom: acc.mom + curr.splits.mom,
            heng: acc.heng + curr.splits.heng,
            yan: acc.yan + curr.splits.yan,
          }), { dad: 0, mom: 0, heng: 0, yan: 0 });
        }, [expenses]);

        const methodSummary = useMemo(() => {
          const methods = {}; 
          expenses.forEach(e => {
            const m = e.paymentMethod.toUpperCase();
            methods[m] = (methods[m] || 0) + e.total;
          });
          return methods;
        }, [expenses]);

        return (
          <div className="pb-24">
            {/* Input Section */}
            <div className="bg-white rounded-2xl p-5 shadow-sm mb-6 border border-stone-100">
              <h2 className="text-lg font-bold text-stone-700 mb-4 flex items-center gap-2">
                <Plus className="w-5 h-5 text-hokkaido-accent" /> æ–°å¢è¨˜å¸³
              </h2>
              
              <div className="space-y-3">
                <input 
                  type="text" 
                  placeholder="é …ç›®åç¨± (e.g. æ™šé¤)" 
                  className="w-full p-3 bg-stone-50 rounded-xl border-none focus:ring-2 focus:ring-hokkaido-blue outline-none"
                  value={title}
                  onChange={(e) => setTitle(e.target.value)}
                />
                
                <div className="space-y-3">
                  <input 
                    type="number" 
                    placeholder="ç¸½é‡‘é¡ Â¥" 
                    className="w-full p-3 bg-stone-50 rounded-xl border-none focus:ring-2 focus:ring-hokkaido-blue outline-none"
                    value={amount}
                    onChange={(e) => setAmount(e.target.value)}
                  />
                  <input 
                    type="text" 
                    placeholder="ä»˜æ¬¾æ–¹å¼" 
                    className="w-full p-3 bg-stone-50 rounded-xl border-none focus:ring-2 focus:ring-hokkaido-blue outline-none"
                    value={paymentMethod}
                    onChange={(e) => setPaymentMethod(e.target.value)}
                  />
                </div>

                <button 
                  onClick={handleSplitEvenly}
                  className="w-full py-2 bg-blue-50 text-blue-600 rounded-lg text-sm font-medium flex items-center justify-center gap-2 hover:bg-blue-100 transition-colors"
                >
                  <Divide size={16} /> è‡ªå‹•å¹³åˆ† (Ã·4)
                </button>

                <div className="grid grid-cols-4 gap-2 text-center text-sm">
                  {['çˆ¸', 'åª½', 'æ†', 'æ®·'].map((name, idx) => {
                    const keys = ['dad', 'mom', 'heng', 'yan']; 
                    const key = keys[idx];
                    return (
                      <div key={key}>
                        <label className="block text-gray-500 text-xs mb-1">{name}</label>
                        <input 
                          type="number" 
                          className="w-full p-2 text-center bg-stone-50 rounded-lg text-xs"
                          value={splits[key] || ''}
                          onChange={(e) => setSplits({...splits, [key]: parseFloat(e.target.value) || 0})}
                        />
                      </div>
                    )
                  })}
                </div>

                <button 
                  onClick={handleAddExpense}
                  className="w-full py-3 bg-hokkaido-text text-white rounded-xl font-bold shadow-md active:scale-95 transition-transform"
                >
                  åŠ å…¥æ¸…å–®
                </button>
              </div>
            </div>

            {/* Summary Section */}
            <div className="grid grid-cols-2 gap-4 mb-6">
              <div className="bg-gradient-to-br from-indigo-50 to-white p-4 rounded-xl shadow-sm border border-indigo-100">
                <h3 className="text-xs text-indigo-400 font-bold mb-1 uppercase tracking-wider">ç¸½æ”¯å‡º</h3>
                <p className="text-2xl font-display font-bold text-indigo-900">Â¥{totalSpent.toLocaleString()}</p>
              </div>
              <div className="bg-white p-4 rounded-xl shadow-sm border border-stone-100">
                <h3 className="text-xs text-stone-400 font-bold mb-2 uppercase tracking-wider">å€‹äººæ‡‰ä»˜</h3>
                <div className="space-y-1 text-xs text-stone-600">
                  <div className="flex justify-between"><span>çˆ¸:</span> <span>Â¥{totalPerPerson.dad.toLocaleString()}</span></div>
                  <div className="flex justify-between"><span>åª½:</span> <span>Â¥{totalPerPerson.mom.toLocaleString()}</span></div>
                  <div className="flex justify-between"><span>æ†:</span> <span>Â¥{totalPerPerson.heng.toLocaleString()}</span></div>
                  <div className="flex justify-between"><span>æ®·:</span> <span>Â¥{totalPerPerson.yan.toLocaleString()}</span></div>
                </div>
              </div>
            </div>

            <div className="bg-white p-4 rounded-xl shadow-sm border border-stone-100 mb-6">
              <h3 className="text-xs text-stone-400 font-bold mb-2 uppercase tracking-wider flex items-center gap-1">
                <CreditCard size={12} /> ä»˜æ¬¾æ–¹å¼åŒ¯ç¸½
              </h3>
              <div className="flex flex-wrap gap-2">
                {Object.entries(methodSummary).map(([method, amt]) => (
                  <span key={method} className="px-3 py-1 bg-stone-100 rounded-full text-xs font-medium text-stone-600">
                    {method}: Â¥{amt.toLocaleString()}
                  </span>
                ))}
              </div>
            </div>

            {/* List */}
            <div className="space-y-3">
              {expenses.map((expense) => (
                <div key={expense.id} className="bg-white p-4 rounded-xl shadow-sm flex justify-between items-center border border-stone-50">
                  <div>
                    <h4 className="font-bold text-stone-800">{expense.item}</h4>
                    <p className="text-xs text-stone-500 mt-1 bg-stone-100 inline-block px-2 py-0.5 rounded">
                      {expense.paymentMethod}
                    </p>
                  </div>
                  <div className="text-right">
                    <div className="font-display font-bold text-stone-800">Â¥{expense.total.toLocaleString()}</div>
                    <button 
                      onClick={() => handleDelete(expense.id)}
                      className="text-red-400 p-2 -mr-2 hover:bg-red-50 rounded-full transition-colors"
                    >
                      <Trash2 size={16} />
                    </button>
                  </div>
                </div>
              ))}
              {expenses.length === 0 && (
                <div className="text-center text-stone-400 py-10">
                  <Calculator className="w-12 h-12 mx-auto mb-2 opacity-20" />
                  <p className="text-sm">å°šæœªæœ‰è¨˜å¸³è³‡æ–™</p>
                </div>
              )}
            </div>
          </div>
        );
      };
      
      // App.js çš„è¼”åŠ©çµ„ä»¶ 
      const CategoryIcon = ({ category }) => { 
        switch (category) {
          case Category.Flight: return <Plane size={18} className="text-indigo-500" />; 
          case Category.Transport: return <Train size={18} className="text-blue-500" />;
          case Category.Food: return <Utensils size={18} className="text-orange-500" />;
          case Category.Sightseeing: return <Camera size={18} className="text-emerald-500" />;
          case Category.Hotel: return <Hotel size={18} className="text-purple-500" />;
          default: return <Info size={18} className="text-gray-500" />;
        }
      };
      
      const Tag = ({ text }) => { 
        const isMust = text.includes('å¿…') || text.includes('No.1') || text.includes('é™å®š');
        const isBooked = text.includes('é ç´„');
        
        let bgClass = "bg-stone-100 text-stone-600";
        if (isMust) bgClass = "bg-hokkaido-accent/10 text-hokkaido-accent border border-hokkaido-accent/20";
        if (isBooked) bgClass = "bg-indigo-50 text-indigo-600 border border-indigo-100";

        return (
          <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${bgClass}`}>
            {text}
          </span>
        );
      };
      
      const Modal = ({ item, onClose }) => { 
        if (!item) return null;
        return (
          <div className="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm p-4 animate-in fade-in duration-200">
            <div className="bg-white w-full max-w-md rounded-3xl overflow-hidden shadow-2xl flex flex-col max-h-[85vh] animate-in slide-in-from-bottom duration-300">
              
              {/* Header Image or Solid Color */}
              <div className="h-32 bg-gradient-to-r from-hokkaido-blue to-indigo-100 relative shrink-0">
                {item.imageUrl && (
                  <img src={item.imageUrl} alt={item.title} className="w-full h-full object-cover opacity-80" />
                )}
                <button 
                  onClick={onClose} 
                  className="absolute top-4 right-4 bg-white/90 p-2 rounded-full shadow-sm hover:bg-white transition-colors"
                >
                  <X size={20} className="text-stone-500" />
                </button>
              
                <div className="absolute bottom-4 left-6">
                  <span className="bg-white/90 px-3 py-1 rounded-full text-xs font-bold text-stone-700 shadow-sm flex items-center gap-1 w-fit">
                    <CategoryIcon category={item.category} />
                    {item.category}
                  </span>
                </div>
              </div>

              {/* Content */}
              <div className="p-6 overflow-y-auto">
                <h2 className="text-2xl font-display font-bold text-stone-800 mb-1">{item.title}</h2>
                {item.jpTitle && <h3 className="text-lg text-stone-400 font-display mb-4">{item.jpTitle}</h3>}

                <div className="space-y-6">
                  {/* Quick Stats */}
                  <div className="grid grid-cols-2 gap-3 text-sm">
                    <div className="bg-stone-50 p-3 rounded-xl flex items-center gap-2">
                      <Clock size={16} className="text-stone-400" />
                      <span className="font-medium text-stone-700">{item.time}</span>
                    </div>
                    {item.cost && (
                      <div className="bg-stone-50 p-3 rounded-xl flex items-center gap-2">
                        <span className="text-stone-400 font-bold">Â¥</span>
                        <span className="font-medium text-stone-700">{item.cost.replace(/Â¥/g, '')}</span>
                      </div>
                    )}
                  </div>

                  {/* Description */}
                  <div>
                    <h4 className="text-xs font-bold text-stone-400 uppercase tracking-wider mb-2">ç°¡ä»‹</h4>
                    <p className="text-stone-600 leading-relaxed">{item.description}</p>
                  </div>

                  {/* Details List */}
                  {item.details && item.details.length > 0 && (
                    <div>
                      <h4 className="text-xs font-bold text-stone-400 uppercase tracking-wider mb-2">è©³ç´°è³‡è¨Š</h4>
                      <ul className="space-y-3">
                        {item.details.map((detail, idx) => {
                           const isHighlight = detail.includes('å¿…åƒ') || detail.includes('å¿…è²·') || detail.includes('æ³¨æ„');
                           return (
                              <li key={idx} className={`flex items-start gap-3 p-3 rounded-xl ${isHighlight ? 'bg-orange-50' : 'bg-stone-50'}`}>
                                <div className={`mt-1.5 w-1.5 h-1.5 rounded-full shrink-0 ${isHighlight ? 'bg-orange-400' : 'bg-stone-300'}`} />
                                <span className={`text-sm ${isHighlight ? 'text-stone-800 font-medium' : 'text-stone-600'}`}>{detail}</span>
                              </li>
                           );
                        })}
                      </ul>
                    </div>
                  )}
                </div>
              </div>

              {/* Footer Actions */}
              <div className="p-4 border-t border-stone-100 bg-stone-50 shrink-0">
                <a 
                  // ä¿®æ­£ Google Map é€£çµ
                  href={`https://maps.google.com/maps?q=${encodeURIComponent(item.location + ' Hokkaido')}`}
                  target="_blank"
                  rel="noreferrer"
                  className="w-full py-3 bg-hokkaido-text text-white rounded-xl font-bold flex items-center justify-center gap-2 shadow-lg hover:bg-stone-700 active:scale-95 transition-all"
                >
                  <Navigation size={18} />
                  å°èˆªå‰å¾€
                </a>
              </div>
            </div>
          </div>
        );
      };

      // Main App Component Enum
      const Tab = { Itinerary: 'itinerary', Expenses: 'expenses', Info: 'info' };

      // Main App Component 
      const App = () => {
        const [activeTab, setActiveTab] = useState(Tab.Itinerary);
        const [selectedDay, setSelectedDay] = useState(1);
        const [selectedItem, setSelectedItem] = useState(null); 
        
        const currentDayPlan = ITINERARY_DATA.find(d => d.day === selectedDay) || ITINERARY_DATA[0];
        
        useEffect(() => {
          // Scroll to top when day changes
          window.scrollTo(0,0);
        }, [selectedDay, activeTab]);
        

        return (
          <div className="min-h-screen font-sans text-hokkaido-text bg-[#f0f2f5] max-w-lg mx-auto shadow-2xl border-x border-white/50 relative">
            
            {/* Header Area */}
            <header className="sticky top-0 z-30 bg-white/95 backdrop-blur-md shadow-sm">
              <div className="flex justify-between items-center p-4">
                <h1 className="text-xl font-display font-bold text-stone-800">
                  {activeTab === Tab.Itinerary && "åŒ—æµ·é“ä¹‹æ—…"}
                  {activeTab === Tab.Expenses && "æ—…è²»è¨˜å¸³"}
                  {activeTab === Tab.Info && "æ—…è¡Œè³‡è¨Š"}
                </h1>
                <div className="text-xs font-bold text-stone-400 bg-stone-100 px-2 py-1 rounded-md">2025 Dec</div>
              </div>

              {/* Day Selector (Only for Itinerary) */}
              {activeTab === Tab.Itinerary && ITINERARY_DATA.length > 0 && (
                <div className="flex overflow-x-auto hide-scrollbar px-4 pb-3 gap-3 snap-x">
                  {ITINERARY_DATA.map((plan) => {
                    const isActive = plan.day === selectedDay;
                    return (
                      <button
                        key={plan.day}
                        onClick={() => setSelectedDay(plan.day)}
                        className={`flex-shrink-0 flex flex-col items-center justify-center w-14 h-16 rounded-2xl transition-all duration-200 snap-center border ${
                          isActive 
                            ? 'bg-hokkaido-text text-white shadow-md scale-105 border-transparent'
                            : 'bg-white text-stone-400 border-stone-200 hover:bg-stone-50'
                        }`}
                      >
                        <span className="text-[10px] font-bold opacity-80">Day {plan.day}</span>
                        <span className="text-lg font-bold font-display">{plan.date.split('/')[1]}</span>
                        <span className="text-[10px]">{plan.weekday}</span>
                      </button>
                    );
                  })}
                </div>
              )}
            </header>

            {/* Main Content */}
            <main className="p-4 min-h-[80vh]">
              {activeTab === Tab.Itinerary && ITINERARY_DATA.length > 0 && (
                <div className="animate-in fade-in slide-in-from-bottom-2 duration-300 pb-20">
                  {/* Daily Header */}
                  <div className="mb-6">
                    <h2 className="text-2xl font-display font-bold text-stone-800 leading-tight">
                      {currentDayPlan.title}
                    </h2>
                    <div className="flex items-center gap-1 text-stone-500 text-sm mt-1">
                      <MapPin size={14} />
                      {currentDayPlan.city}
                    </div>
                  </div>

                  {/* Weather Widget */}
                  <WeatherWidget lat={currentDayPlan.lat} lng={currentDayPlan.lng} city={currentDayPlan.city} />

                  {/* Timeline Items */}
                  <div className="space-y-4 relative pl-4 border-l-2 border-stone-200 ml-2">
                    {currentDayPlan.items.map((item, idx) => (
                      <div 
                        key={item.id} 
                        onClick={() => setSelectedItem(item)}
                        className="relative group cursor-pointer"
                      >
                        {/* Timeline Dot */}
                        <div className={`absolute -left-[25px] top-4 w-4 h-4 rounded-full border-2 border-white shadow-sm z-10 
                          ${item.category === Category.Transport ? 'bg-blue-400' :
                            item.category === Category.Flight ? 'bg-indigo-400' :
                            item.category === Category.Food ? 'bg-orange-400' :
                            item.category === Category.Sightseeing ? 'bg-emerald-400' : 'bg-purple-400'}`}
                        />

                        {/* Card */}
                        <div className="bg-white rounded-2xl p-4 shadow-sm border border-stone-100 transition-all active:scale-[0.98] hover:shadow-md">
                          <div className="flex justify-between items-start mb-2">
                            <span className="text-xs font-bold text-stone-400 bg-stone-50 px-2 py-1 rounded-md">
                               {item.time}
                             </span>
                             <div className="flex items-center gap-1 opacity-20 group-hover:opacity-100 transition-opacity">
                               <ChevronRight size={16} />
                             </div>
                          </div>
                          
                          <div className="flex items-start justify-between gap-4">
                            <div>
                              <h3 className="font-bold text-stone-800 text-lg leading-snug mb-1">{item.title}</h3>
                              <p className="text-stone-500 text-sm line-clamp-2 mb-3">
                                 {item.description}
                              </p>
                            </div>
                            {/* Category Icon */}
                            <div className="bg-stone-50 p-2 rounded-xl shrink-0">
                               <CategoryIcon category={item.category} />
                            </div>
                          </div>

                          {/* Tags */}
                          {item.tags && item.tags.length > 0 && (
                            <div className="flex flex-wrap gap-2 mt-1">
                              {item.tags.map(tag => <Tag key={tag} text={tag} />)}
                            </div>
                          )}
                        </div>
                      </div>
                    ))}
                  </div>
                
                  {/* End of Day Marker */}
                  <div className="mt-8 text-center">
                    <span className="text-xs text-stone-300 font-display tracking-widest uppercase">End of Day {selectedDay}</span>
                  </div>
                </div>
              )}

              {activeTab === Tab.Expenses && (
                <div className="animate-in fade-in duration-300">
                  <ExpenseTracker />
                </div>
              )}

              {activeTab === Tab.Info && (
                <div className="animate-in fade-in duration-300">
                  <InfoView />
                </div>
              )}
            </main>

            {/* Bottom Navigation */}
            <nav className="fixed bottom-0 left-0 right-0 max-w-lg mx-auto bg-white border-t border-stone-100 pb-safe pt-2 px-6 shadow-[0_-5px_20px_rgba(0,0,0,0.03)] z-40">
              <div className="flex justify-between items-center h-16">
                <button 
                  onClick={() => setActiveTab(Tab.Itinerary)}
                  className={`flex flex-col items-center gap-1 transition-colors ${activeTab === Tab.Itinerary ? 'text-stone-800' : 'text-stone-400'}`}
                >
                  <Calendar size={24} strokeWidth={activeTab === Tab.Itinerary ? 2.5 : 2} />
                  <span className="text-[10px] font-bold">è¡Œç¨‹</span>
                </button>
                
                <button 
                  onClick={() => setActiveTab(Tab.Expenses)}
                  className={`flex flex-col items-center gap-1 transition-colors ${activeTab === Tab.Expenses ? 'text-stone-800' : 'text-stone-400'}`}
                >
                  <Wallet size={24} strokeWidth={activeTab === Tab.Expenses ? 2.5 : 2} />
                  <span className="text-[10px] font-bold">è¨˜å¸³</span>
                </button>

                <button 
                  onClick={() => setActiveTab(Tab.Info)}
                  className={`flex flex-col items-center gap-1 transition-colors ${activeTab === Tab.Info ? 'text-stone-800' : 'text-stone-400'}`}
                >
                  <Info size={24} strokeWidth={activeTab === Tab.Info ? 2.5 : 2} />
                  <span className="text-[10px] font-bold">è³‡è¨Š</span>
                </button>
              </div>
            </nav>

            {/* Item Detail Modal */}
            {selectedItem && (
              <Modal item={selectedItem} onClose={() => setSelectedItem(null)} />
            )}

          </div>
        );
      };

      // --- 3. index.js æ¸²æŸ“é‚è¼¯ ---
      const rootElement = document.getElementById('root');
      
      if (!rootElement) {
        throw new Error("Could not find root element to mount to");
      }

      const root = ReactDOM.createRoot(rootElement);
      
      root.render(
        <React.StrictMode>
          <App />
        </React.StrictMode>
      );
    </script> 
  </body>
</html>
